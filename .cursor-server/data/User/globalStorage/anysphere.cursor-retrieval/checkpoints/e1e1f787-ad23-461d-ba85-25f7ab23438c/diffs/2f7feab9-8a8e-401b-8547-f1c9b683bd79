{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"2f7feab9-8a8e-401b-8547-f1c9b683bd79","fileSizeBytes":69265,"numLines":1592,"diffChanges":[{"originalStartLineNumberOneIndexed":70,"originalEndLineNumberExclusiveOneIndexed":70,"modifiedStartLineNumberOneIndexed":70,"modifiedEndLineNumberExclusiveOneIndexed":102,"addedLines":["","  // Get the currently active video element (main video or remix)","  const getCurrentActiveVideo = useCallback(() => {","    if (currentRemixIndex === 0) {","      // Original video is active","      return videoRef.current;","    } else {","      // A remix is active - the main video should be showing the remix","      return videoRef.current;","    }","  }, [currentRemixIndex]);","","  // Pause all videos except the specified one","  const pauseAllVideosExcept = useCallback((exceptVideo: HTMLVideoElement | null) => {","    const videos = [videoRef.current, prevRemixVideoRef.current, nextRemixVideoRef.current];","    videos.forEach(video => {","      if (video && video !== exceptVideo && !video.paused) {","        console.log('â¸ï¸ Pausing video (cleanup)');","        video.pause();","      }","    });","  }, []);","","  // Mute all videos except the specified one","  const muteAllVideosExcept = useCallback((exceptVideo: HTMLVideoElement | null) => {","    const videos = [videoRef.current, prevRemixVideoRef.current, nextRemixVideoRef.current];","    videos.forEach(video => {","      if (video && video !== exceptVideo) {","        video.muted = true;","      }","    });","  }, []);"],"tokenizedAddedLines":[2,1001013,1001014,1001015,1001016,1001017,188,1001018,1001017,55,103,2,1001019,1001020,1001021,1001022,1001023,1001024,192,94,95,138,2,1001025,1001026,1001021,1001022,1001027,195,94,95,138]},{"originalStartLineNumberOneIndexed":184,"originalEndLineNumberExclusiveOneIndexed":185,"modifiedStartLineNumberOneIndexed":216,"modifiedEndLineNumberExclusiveOneIndexed":217,"addedLines":["    // Don't interfere if we're currently scrolling between remixes"],"tokenizedAddedLines":[1001028]},{"originalStartLineNumberOneIndexed":249,"originalEndLineNumberExclusiveOneIndexed":275,"modifiedStartLineNumberOneIndexed":281,"modifiedEndLineNumberExclusiveOneIndexed":293,"addedLines":["    const mainVideo = videoRef.current;","","    // Determine which video should be playing during scroll","    let targetVideo: HTMLVideoElement | null = null;","","    if (remixScrollDirection === 'right' && targetRemixIndex === currentRemixIndex - 1 && prevVideo) {","      // Scrolling to previous remix","      targetVideo = prevVideo;","      console.log('â–¶ï¸ Starting previous remix video during scroll');","    } else if (remixScrollDirection === 'left' && targetRemixIndex === currentRemixIndex + 1 && nextVideo) {","      // Scrolling to next remix","      targetVideo = nextVideo;"],"tokenizedAddedLines":[1001029,2,1001030,1001031,2,1001032,1001033,1001034,1001035,1001036,1001037,1001038]},{"originalStartLineNumberOneIndexed":276,"originalEndLineNumberExclusiveOneIndexed":296,"modifiedStartLineNumberOneIndexed":294,"modifiedEndLineNumberExclusiveOneIndexed":314,"addedLines":["    } else if (!remixScrollDirection && mainVideo) {","      // Not scrolling - main video should be active","      targetVideo = mainVideo;","    }","","    // Pause all videos except the target","    pauseAllVideosExcept(targetVideo);","    ","    // Mute all videos except the target","    muteAllVideosExcept(targetVideo);","","    // Start playing the target video","    if (targetVideo && targetVideo.paused && !userPausedRef.current) {","      targetVideo.muted = isActive ? isMuted : false; // Use user preference for active video","      targetVideo.play().catch(() => console.log('âŒ Target video play failed'));","    }","  }, [hasRemixes, isActive, remixScrollDirection, targetRemixIndex, currentRemixIndex, pauseAllVideosExcept, muteAllVideosExcept, isMuted]);","","  // Pause and mute ALL videos when main video becomes inactive (scrolling up/down)","  useEffect(() => {"],"tokenizedAddedLines":[1001039,1001040,1001041,55,2,1001042,1001043,73,1001044,1001045,2,1001046,1001047,1001048,1001049,55,1001050,2,1001051,67]},{"originalStartLineNumberOneIndexed":297,"originalEndLineNumberExclusiveOneIndexed":325,"modifiedStartLineNumberOneIndexed":315,"modifiedEndLineNumberExclusiveOneIndexed":351,"addedLines":["      // Main video is not active (scrolled away) - pause and mute all videos","      console.log('â¸ï¸ Main video inactive - pausing all videos');","      pauseAllVideosExcept(null); // Pause all videos","      muteAllVideosExcept(null);  // Mute all videos","    }","  }, [isActive, pauseAllVideosExcept, muteAllVideosExcept]);","","  // Sync isPlaying state with actual video state for the currently active video","  useEffect(() => {","    const activeVideo = getCurrentActiveVideo();","    if (!activeVideo) return;","","    const syncPlayingState = () => {","      const actuallyPlaying = !activeVideo.paused;","      if (actuallyPlaying !== isPlaying) {","        console.log('ðŸ”„ Syncing playing state:', { ","          actuallyPlaying, ","          reactIsPlaying: isPlaying, ","          currentRemixIndex ","        });","        setIsPlaying(actuallyPlaying);","      }","    };","","    // Sync immediately","    syncPlayingState();","","    // Listen for play/pause events to keep in sync","    activeVideo.addEventListener('play', syncPlayingState);","    activeVideo.addEventListener('pause', syncPlayingState);","","    return () => {","      activeVideo.removeEventListener('play', syncPlayingState);","      activeVideo.removeEventListener('pause', syncPlayingState);","    };","  }, [getCurrentActiveVideo, isPlaying, currentRemixIndex]);"],"tokenizedAddedLines":[1001052,1001053,1001054,1001055,55,1001056,2,1001057,67,1001058,1001059,2,1001060,1001061,1001062,1001063,1001064,1001065,1001066,179,1001067,94,134,2,1001068,1001069,2,1001070,1001071,1001072,2,467,1001073,1001074,134,1001075]},{"originalStartLineNumberOneIndexed":637,"originalEndLineNumberExclusiveOneIndexed":638,"modifiedStartLineNumberOneIndexed":663,"modifiedEndLineNumberExclusiveOneIndexed":664,"addedLines":["  // Handle click - toggle controls and pause for the currently active video"],"tokenizedAddedLines":[1001076]},{"originalStartLineNumberOneIndexed":641,"originalEndLineNumberExclusiveOneIndexed":650,"modifiedStartLineNumberOneIndexed":667,"modifiedEndLineNumberExclusiveOneIndexed":682,"addedLines":["    const activeVideo = getCurrentActiveVideo();","    if (!activeVideo) return;","","    // Check the actual video state, not just React state","    const actuallyPlaying = !activeVideo.paused;","    console.log('ðŸ–±ï¸ Video clicked:', { ","      currentRemixIndex, ","      actuallyPlaying, ","      reactIsPlaying: isPlaying, ","      videoReady ","    });","    ","    if (actuallyPlaying) {","      console.log('â¸ï¸ Pausing active video (user click)');","      activeVideo.pause();"],"tokenizedAddedLines":[1001058,1001059,2,1001077,1001078,1001079,1001080,1001081,147,1001082,95,73,1001083,1001084,1001085]},{"originalStartLineNumberOneIndexed":653,"originalEndLineNumberExclusiveOneIndexed":655,"modifiedStartLineNumberOneIndexed":685,"modifiedEndLineNumberExclusiveOneIndexed":687,"addedLines":["      console.log('â–¶ï¸ Playing active video (user click)');","      activeVideo.play().then(() => {"],"tokenizedAddedLines":[1001086,1001087]},{"originalStartLineNumberOneIndexed":665,"originalEndLineNumberExclusiveOneIndexed":666,"modifiedStartLineNumberOneIndexed":697,"modifiedEndLineNumberExclusiveOneIndexed":698,"addedLines":["  }, [getCurrentActiveVideo, isPlaying, handleInteraction, videoReady]);"],"tokenizedAddedLines":[1001088]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}