{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"7d016e9b-8a0b-401e-a4e3-3f22b623c80e","fileSizeBytes":26835,"numLines":785,"diffChanges":[{"originalStartLineNumberOneIndexed":27,"originalEndLineNumberExclusiveOneIndexed":28,"modifiedStartLineNumberOneIndexed":27,"modifiedEndLineNumberExclusiveOneIndexed":55,"addedLines":["// Unified Video Management System","interface VideoElement {","  ref: React.RefObject<HTMLVideoElement | null>;","  position: { x: number; y: number }; // Relative position (0,0 = center)","  item: SoraFeedItem;","  isActive: boolean;","  isTarget: boolean; // Target during scroll transition","  shouldPlay: boolean;","  shouldMute: boolean;","}","","export default function VideoPost({ ","  item, ","  isActive, ","  isUpcoming, ","  isTargetVideo, ","  scrollDirection, ","  onNext, ","  onAddToFavorites, ","  onRemoveFromFavorites, ","  isInFavorites, ","  onRemixStatusChange, ","  onKeyboardNavigation, ","  preloadedRemixFeed, ","  onControlsChange ","}: VideoPostProps) {","  ","  // ===== UNIFIED STATE MANAGEMENT ====="],"tokenizedAddedLines":[1001050,1001051,1001052,1001053,10,11,1001054,1001055,1001056,24,2,1001057,1001058,1001059,1001060,1001061,1001062,1001063,1001064,1001065,1001066,1001067,1001068,1001069,1001070,1001071,61,1001072]},{"originalStartLineNumberOneIndexed":29,"originalEndLineNumberExclusiveOneIndexed":30,"modifiedStartLineNumberOneIndexed":56,"modifiedEndLineNumberExclusiveOneIndexed":57,"addedLines":["  const [isMuted, setIsMuted] = useState(false);"],"tokenizedAddedLines":[1001073]},{"originalStartLineNumberOneIndexed":34,"originalEndLineNumberExclusiveOneIndexed":34,"modifiedStartLineNumberOneIndexed":61,"modifiedEndLineNumberExclusiveOneIndexed":66,"addedLines":["  const [videoWidth, setVideoWidth] = useState<number | null>(null);","  const [videoReady, setVideoReady] = useState(false);","  const [isMobile, setIsMobile] = useState(false);","  ","  // Remix state"],"tokenizedAddedLines":[37,38,36,61,1001074]},{"originalStartLineNumberOneIndexed":37,"originalEndLineNumberExclusiveOneIndexed":46,"modifiedStartLineNumberOneIndexed":69,"modifiedEndLineNumberExclusiveOneIndexed":82,"addedLines":["  ","  // Unified scroll state","  const [scrollState, setScrollState] = useState<{","    direction: 'up' | 'down' | 'left' | 'right' | null;","    targetIndex: number | null;","    isScrolling: boolean;","  }>({","    direction: null,","    targetIndex: null,","    isScrolling: false","  });","  ","  // Motion values for both directions"],"tokenizedAddedLines":[61,1001075,1001076,1001077,1001078,1001079,1001080,1001081,1001082,1001083,1001084,61,1001085]},{"originalStartLineNumberOneIndexed":47,"originalEndLineNumberExclusiveOneIndexed":49,"modifiedStartLineNumberOneIndexed":83,"modifiedEndLineNumberExclusiveOneIndexed":94,"addedLines":["  const y = useMotionValue(0); // For potential future vertical remix scrolling","  ","  // Video refs - unified grid system","  const centerVideoRef = useRef<HTMLVideoElement>(null);","  const leftVideoRef = useRef<HTMLVideoElement>(null);","  const rightVideoRef = useRef<HTMLVideoElement>(null);","  const upVideoRef = useRef<HTMLVideoElement>(null);","  const downVideoRef = useRef<HTMLVideoElement>(null);","  ","  // Control refs","  const userPausedRef = useRef(false);"],"tokenizedAddedLines":[1001086,61,1001087,1001088,1001089,1001090,1001091,1001092,61,1001093,50]},{"originalStartLineNumberOneIndexed":51,"originalEndLineNumberExclusiveOneIndexed":192,"modifiedStartLineNumberOneIndexed":96,"modifiedEndLineNumberExclusiveOneIndexed":177,"addedLines":["  const lastInteractionRef = useRef<number>(Date.now());","  ","  // ===== UNIFIED VIDEO MANAGEMENT =====","  ","  // Get all available items (original + remixes)","  const getAllItems = useCallback((): SoraFeedItem[] => {","    return [item, ...remixFeed];","  }, [item, remixFeed]);","  ","  // Get current item based on remix index","  const getCurrentItem = useCallback((): SoraFeedItem => {","    const allItems = getAllItems();","    return allItems[currentRemixIndex] || item;","  }, [currentRemixIndex, getAllItems, item]);","  ","  // Create video element grid","  const createVideoGrid = useCallback((): VideoElement[] => {","    const allItems = getAllItems();","    const grid: VideoElement[] = [];","    ","    // Center video (current)","    grid.push({","      ref: centerVideoRef,","      position: { x: 0, y: 0 },","      item: getCurrentItem(),","      isActive: isActive && !scrollState.isScrolling,","      isTarget: false,","      shouldPlay: isActive && !scrollState.isScrolling && !userPausedRef.current,","      shouldMute: isMuted || !isActive","    });","    ","    // Left video (previous remix)","    if (currentRemixIndex > 0) {","      const leftItem = allItems[currentRemixIndex - 1];","      grid.push({","        ref: leftVideoRef,","        position: { x: -1, y: 0 },","        item: leftItem,","        isActive: false,","        isTarget: scrollState.direction === 'left' && scrollState.targetIndex === currentRemixIndex - 1,","        shouldPlay: scrollState.direction === 'left' && scrollState.targetIndex === currentRemixIndex - 1,","        shouldMute: true","      });","    }","    ","    // Right video (next remix)","    if (currentRemixIndex < allItems.length - 1) {","      const rightItem = allItems[currentRemixIndex + 1];","      grid.push({","        ref: rightVideoRef,","        position: { x: 1, y: 0 },","        item: rightItem,","        isActive: false,","        isTarget: scrollState.direction === 'right' && scrollState.targetIndex === currentRemixIndex + 1,","        shouldPlay: scrollState.direction === 'right' && scrollState.targetIndex === currentRemixIndex + 1,","        shouldMute: true","      });","    }","    ","    return grid;","  }, [getAllItems, getCurrentItem, currentRemixIndex, isActive, scrollState, isMuted]);","  ","  // ===== UNIFIED VIDEO CONTROL =====","  ","  // Control all videos based on grid state","  const controlAllVideos = useCallback(() => {","    const grid = createVideoGrid();","    ","    grid.forEach(videoElement => {","      const video = videoElement.ref.current;","      if (!video) return;","      ","      // Set mute state","      video.muted = videoElement.shouldMute;","      ","      // Control playback","      if (videoElement.shouldPlay && video.paused) {","        console.log(`â–¶ï¸ Playing video at position (${videoElement.position.x}, ${videoElement.position.y})`);","        video.play().catch(err => console.log('âŒ Play failed:', err));","      } else if (!videoElement.shouldPlay && !video.paused) {","        console.log(`â¸ï¸ Pausing video at position (${videoElement.position.x}, ${videoElement.position.y})`);"],"tokenizedAddedLines":[46,61,1001094,61,1001095,1001096,1001097,1001098,61,1001099,52,1001100,1001101,1001102,61,1001103,1001104,1001100,1001105,95,1001106,1001107,1001108,1001109,1001110,1001111,1001112,1001113,1001114,82,95,1001115,334,1001116,1001117,1001118,1001119,1001120,1001121,1001122,1001123,1001124,158,55,95,1001125,1001126,1001127,1001117,1001128,1001129,1001130,1001121,1001131,1001132,1001124,158,55,95,1001133,1001134,61,1001135,61,1001136,1001137,1001138,95,1001139,1001140,1001141,194,1001142,1001143,194,1001144,1001145,1001146,1001147,1001148,1001149]},{"originalStartLineNumberOneIndexed":193,"originalEndLineNumberExclusiveOneIndexed":214,"modifiedStartLineNumberOneIndexed":178,"modifiedEndLineNumberExclusiveOneIndexed":191,"addedLines":["      }","    });","    ","    // Update React state based on center video","    const centerVideo = centerVideoRef.current;","    if (centerVideo) {","      setIsPlaying(!centerVideo.paused);","    }","  }, [createVideoGrid]);","  ","  // ===== SCROLL DETECTION =====","  ","  // Unified scroll detection for horizontal (remix) scrolling"],"tokenizedAddedLines":[81,82,95,1001150,1001151,1001152,1001153,55,1001154,61,1001155,61,1001156]},{"originalStartLineNumberOneIndexed":215,"originalEndLineNumberExclusiveOneIndexed":329,"modifiedStartLineNumberOneIndexed":192,"modifiedEndLineNumberExclusiveOneIndexed":235,"addedLines":["    if (remixFeed.length === 0) return;","    ","    const unsubscribe = x.on('change', (latest) => {","      const threshold = 50;","      ","      if (Math.abs(latest) > threshold) {","        if (latest < -threshold && currentRemixIndex < remixFeed.length) {","          // Scrolling left to next remix","          const targetIndex = currentRemixIndex + 1;","          if (scrollState.direction !== 'right' || scrollState.targetIndex !== targetIndex) {","            setScrollState({","              direction: 'right',","              targetIndex,","              isScrolling: true","            });","          }","        } else if (latest > threshold && currentRemixIndex > 0) {","          // Scrolling right to previous remix","          const targetIndex = currentRemixIndex - 1;","          if (scrollState.direction !== 'left' || scrollState.targetIndex !== targetIndex) {","            setScrollState({","              direction: 'left',","              targetIndex,","              isScrolling: true","            });","          }","        }","      } else if (Math.abs(latest) < 10) {","        // Reset when back to center","        setScrollState({","          direction: null,","          targetIndex: null,","          isScrolling: false","        });","      }","    });","    ","    return unsubscribe;","  }, [x, currentRemixIndex, remixFeed.length, scrollState]);","  ","  // ===== UNIFIED VIDEO CONTROL EFFECT =====","  ","  // Single effect to control all videos"],"tokenizedAddedLines":[1001157,95,96,1001158,194,1001159,1001160,1001161,1001162,1001163,1001164,1001165,1001166,1001167,395,104,1001168,1001169,1001170,1001171,1001164,1001172,1001166,1001167,395,104,111,112,113,1001173,1001174,1001175,1001176,209,81,82,95,116,1001177,61,1001178,61,1001179]},{"originalStartLineNumberOneIndexed":331,"originalEndLineNumberExclusiveOneIndexed":422,"modifiedStartLineNumberOneIndexed":237,"modifiedEndLineNumberExclusiveOneIndexed":245,"addedLines":["      // Pause and mute all videos when inactive","      [centerVideoRef, leftVideoRef, rightVideoRef, upVideoRef, downVideoRef].forEach(ref => {","        const video = ref.current;","        if (video) {","          video.pause();","          video.muted = true;","        }","      });"],"tokenizedAddedLines":[1001180,1001181,1001182,153,154,155,111,158]},{"originalStartLineNumberOneIndexed":423,"originalEndLineNumberExclusiveOneIndexed":463,"modifiedStartLineNumberOneIndexed":246,"modifiedEndLineNumberExclusiveOneIndexed":259,"addedLines":["      return;","    }","    ","    // Control videos based on current state","    controlAllVideos();","  }, [isActive, scrollState, currentRemixIndex, isMuted, controlAllVideos]);","  ","  // ===== NAVIGATION FUNCTIONS =====","  ","  // Unified navigation with animation support","  const navigateToRemix = useCallback((targetIndex: number, animated = true) => {","    if (targetIndex < 0 || targetIndex >= getAllItems().length) return;","    "],"tokenizedAddedLines":[518,55,95,1001183,1001184,1001185,61,1001186,61,1001187,1001188,1001189,95]},{"originalStartLineNumberOneIndexed":464,"originalEndLineNumberExclusiveOneIndexed":467,"modifiedStartLineNumberOneIndexed":260,"modifiedEndLineNumberExclusiveOneIndexed":262,"addedLines":["      const direction = targetIndex > currentRemixIndex ? -1 : 1;","      animate(x, direction * window.innerWidth, {"],"tokenizedAddedLines":[1001190,1001191]},{"originalStartLineNumberOneIndexed":471,"originalEndLineNumberExclusiveOneIndexed":478,"modifiedStartLineNumberOneIndexed":266,"modifiedEndLineNumberExclusiveOneIndexed":267,"addedLines":["          setCurrentRemixIndex(targetIndex);"],"tokenizedAddedLines":[1001192]},{"originalStartLineNumberOneIndexed":479,"originalEndLineNumberExclusiveOneIndexed":496,"modifiedStartLineNumberOneIndexed":268,"modifiedEndLineNumberExclusiveOneIndexed":269,"addedLines":["          setScrollState({ direction: null, targetIndex: null, isScrolling: false });"],"tokenizedAddedLines":[1001193]},{"originalStartLineNumberOneIndexed":499,"originalEndLineNumberExclusiveOneIndexed":501,"modifiedStartLineNumberOneIndexed":272,"modifiedEndLineNumberExclusiveOneIndexed":273,"addedLines":["      setCurrentRemixIndex(targetIndex);"],"tokenizedAddedLines":[1001194]},{"originalStartLineNumberOneIndexed":502,"originalEndLineNumberExclusiveOneIndexed":529,"modifiedStartLineNumberOneIndexed":274,"modifiedEndLineNumberExclusiveOneIndexed":319,"addedLines":["      setScrollState({ direction: null, targetIndex: null, isScrolling: false });","    }","  }, [currentRemixIndex, getAllItems, x]);","  ","  const goToNextRemix = useCallback((animated = true) => {","    navigateToRemix(currentRemixIndex + 1, animated);","  }, [currentRemixIndex, navigateToRemix]);","  ","  const goToPreviousRemix = useCallback((animated = true) => {","    navigateToRemix(currentRemixIndex - 1, animated);","  }, [currentRemixIndex, navigateToRemix]);","  ","  const goToRemixIndex = useCallback((index: number) => {","    navigateToRemix(index, true);","  }, [navigateToRemix]);","  ","  // ===== USER INTERACTION HANDLERS =====","  ","  // Unified click handler","  const handleVideoClick = useCallback((e: React.MouseEvent) => {","    e.stopPropagation();","    ","    const centerVideo = centerVideoRef.current;","    if (!centerVideo) return;","    ","    const actuallyPlaying = !centerVideo.paused;","    console.log('ðŸ–±ï¸ Video clicked:', { ","      currentRemixIndex, ","      actuallyPlaying, ","      reactIsPlaying: isPlaying ","    });","    ","    if (actuallyPlaying) {","      centerVideo.pause();","      setIsPlaying(false);","      userPausedRef.current = true;","    } else {","      centerVideo.play().then(() => {","        setIsPlaying(true);","        userPausedRef.current = false;","      }).catch(() => {","        setIsPlaying(false);","      });","    }","    "],"tokenizedAddedLines":[1001195,55,1001196,61,1001197,1001198,1001199,61,1001200,1001201,1001199,61,1001202,1001203,1001204,61,1001205,61,1001206,474,475,95,1001151,1001207,95,1001208,478,479,480,1001209,82,95,482,1001210,223,485,71,1001211,489,490,491,493,158,55,95]},{"originalStartLineNumberOneIndexed":530,"originalEndLineNumberExclusiveOneIndexed":547,"modifiedStartLineNumberOneIndexed":320,"modifiedEndLineNumberExclusiveOneIndexed":344,"addedLines":["  }, [currentRemixIndex, isPlaying]);","  ","  // Interaction tracking","  const handleInteraction = useCallback(() => {","    lastInteractionRef.current = Date.now();","    hasUserInteractedRef.current = true;","  }, []);","  ","  // Mouse handlers","  const handleMouseEnter = useCallback(() => {","    setIsHovering(true);","  }, []);","  ","  const handleMouseLeave = useCallback(() => {","    setIsHovering(false);","  }, []);","  ","  // ===== DRAG HANDLERS =====","  ","  // Unified drag handler for remix navigation","  const bind = useDrag(","    ({ active, movement: [mx], direction: [dx], velocity: [vx] }) => {","      if (!active) {","        // Determine if we should navigate"],"tokenizedAddedLines":[1001212,61,1001213,462,463,464,83,61,1001214,466,467,83,61,471,472,83,61,1001215,61,1001216,367,1001217,1001218,1001219]},{"originalStartLineNumberOneIndexed":548,"originalEndLineNumberExclusiveOneIndexed":573,"modifiedStartLineNumberOneIndexed":345,"modifiedEndLineNumberExclusiveOneIndexed":355,"addedLines":["        const velocityThreshold = 0.5;","        ","        if (Math.abs(mx) > threshold || Math.abs(vx) > velocityThreshold) {","          if (mx < 0 || (dx < 0 && Math.abs(vx) > velocityThreshold)) {","            // Swiped left - go to next remix","            goToNextRemix(false);","          } else if (mx > 0 || (dx > 0 && Math.abs(vx) > velocityThreshold)) {","            // Swiped right - go to previous remix","            goToPreviousRemix(false);","          }"],"tokenizedAddedLines":[1001220,433,1001221,1001222,1001223,1001224,1001225,1001226,1001227,104]},{"originalStartLineNumberOneIndexed":574,"originalEndLineNumberExclusiveOneIndexed":580,"modifiedStartLineNumberOneIndexed":356,"modifiedEndLineNumberExclusiveOneIndexed":358,"addedLines":["          // Snap back to center","          animate(x, 0, { type: 'spring', stiffness: 400, damping: 40 });"],"tokenizedAddedLines":[1001228,1001229]},{"originalStartLineNumberOneIndexed":582,"originalEndLineNumberExclusiveOneIndexed":596,"modifiedStartLineNumberOneIndexed":360,"modifiedEndLineNumberExclusiveOneIndexed":361,"addedLines":["        // Update position during drag"],"tokenizedAddedLines":[1001230]},{"originalStartLineNumberOneIndexed":597,"originalEndLineNumberExclusiveOneIndexed":658,"modifiedStartLineNumberOneIndexed":362,"modifiedEndLineNumberExclusiveOneIndexed":399,"addedLines":["      }","    },","    {","      axis: 'x',","      bounds: { left: -window.innerWidth, right: window.innerWidth },","      rubberband: true","    }","  );","  ","  // ===== INITIALIZATION EFFECTS =====","  ","  // Load remix feed","  useEffect(() => {","    if (isActive && remixFeed.length === 0 && !loadingRemixes) {","      if (preloadedRemixFeed && preloadedRemixFeed.length > 0) {","        setRemixFeed(preloadedRemixFeed);","      } else {","        // Load remix feed","        const loadRemixFeed = async () => {","          setLoadingRemixes(true);","          try {","            const remixes = await remixCache.getRemixFeed(item.post.id);","            setRemixFeed(remixes);","          } catch (error) {","            console.error('Failed to load remix feed:', error);","            setRemixFeed([]);","          } finally {","            setLoadingRemixes(false);","          }","        };","        ","        loadRemixFeed();","      }","    }","  }, [isActive, remixFeed.length, loadingRemixes, preloadedRemixFeed, item.post.id]);","  ","  // Reset state when item changes"],"tokenizedAddedLines":[81,418,419,1001231,1001232,1001233,55,422,61,1001234,61,1001235,89,279,281,282,216,1001236,1001237,1001238,1001239,1001240,1001241,1001242,1001243,1001244,1001245,1001246,104,1001247,433,283,81,55,1001248,61,1001249]},{"originalStartLineNumberOneIndexed":659,"originalEndLineNumberExclusiveOneIndexed":698,"modifiedStartLineNumberOneIndexed":400,"modifiedEndLineNumberExclusiveOneIndexed":417,"addedLines":["    console.log('ðŸ”„ Video item changed:', item.post.id);","    ","    // Cleanup all videos","    [centerVideoRef, leftVideoRef, rightVideoRef, upVideoRef, downVideoRef].forEach(ref => {","      const video = ref.current;","      if (video) {","        video.pause();","        video.muted = true;","        video.currentTime = 0;","      }","    });","    ","    // Reset state","    setRemixFeed([]);","    setCurrentRemixIndex(0);","    setLoadingRemixes(false);","    setVideoReady(false);"],"tokenizedAddedLines":[124,95,1001250,1001251,1001252,1001253,80,87,1001254,81,82,95,1001255,134,135,136,137]},{"originalStartLineNumberOneIndexed":699,"originalEndLineNumberExclusiveOneIndexed":705,"modifiedStartLineNumberOneIndexed":418,"modifiedEndLineNumberExclusiveOneIndexed":420,"addedLines":["    setScrollState({ direction: null, targetIndex: null, isScrolling: false });","    x.set(0);"],"tokenizedAddedLines":[1001256,119]},{"originalStartLineNumberOneIndexed":706,"originalEndLineNumberExclusiveOneIndexed":716,"modifiedStartLineNumberOneIndexed":421,"modifiedEndLineNumberExclusiveOneIndexed":425,"addedLines":["    hasUserInteractedRef.current = false;","  }, [item.post.id, x]);","  ","  // Cleanup on unmount"],"tokenizedAddedLines":[139,1001257,61,1001258]},{"originalStartLineNumberOneIndexed":717,"originalEndLineNumberExclusiveOneIndexed":721,"modifiedStartLineNumberOneIndexed":426,"modifiedEndLineNumberExclusiveOneIndexed":440,"addedLines":["    return () => {","      console.log('ðŸ§¹ VideoPost unmounting - cleaning up all videos');","      [centerVideoRef, leftVideoRef, rightVideoRef, upVideoRef, downVideoRef].forEach(ref => {","        const video = ref.current;","        if (video) {","          video.pause();","          video.muted = true;","          video.currentTime = 0;","        }","      });","    };","  }, []);","  ","  // Update favorites"],"tokenizedAddedLines":[149,150,1001181,1001182,153,154,155,157,111,158,159,83,61,1001259]},{"originalStartLineNumberOneIndexed":722,"originalEndLineNumberExclusiveOneIndexed":726,"modifiedStartLineNumberOneIndexed":441,"modifiedEndLineNumberExclusiveOneIndexed":447,"addedLines":["    if (isInFavorites) {","      setIsLiked(isInFavorites(getCurrentItem().post.id));","    }","  }, [getCurrentItem, isInFavorites]);","  ","  // Detect mobile"],"tokenizedAddedLines":[90,91,55,1001260,61,1001261]},{"originalStartLineNumberOneIndexed":727,"originalEndLineNumberExclusiveOneIndexed":731,"modifiedStartLineNumberOneIndexed":448,"modifiedEndLineNumberExclusiveOneIndexed":460,"addedLines":["    const checkMobile = () => {","      const isMobileDevice = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) || ","                            (window.matchMedia && window.matchMedia('(max-width: 768px)').matches);","      setIsMobile(isMobileDevice);","    };","    ","    checkMobile();","    window.addEventListener('resize', checkMobile);","    return () => window.removeEventListener('resize', checkMobile);","  }, []);","  ","  // Controls visibility"],"tokenizedAddedLines":[162,163,164,165,159,95,166,167,168,83,61,1001262]},{"originalStartLineNumberOneIndexed":732,"originalEndLineNumberExclusiveOneIndexed":740,"modifiedStartLineNumberOneIndexed":461,"modifiedEndLineNumberExclusiveOneIndexed":468,"addedLines":["    setShowControls(!isPlaying);","    if (onControlsChange) {","      onControlsChange(!isPlaying);","    }","  }, [isPlaying, onControlsChange]);","  ","  // Notify remix status"],"tokenizedAddedLines":[459,290,1001263,55,1001264,61,1001265]},{"originalStartLineNumberOneIndexed":741,"originalEndLineNumberExclusiveOneIndexed":751,"modifiedStartLineNumberOneIndexed":469,"modifiedEndLineNumberExclusiveOneIndexed":476,"addedLines":["    if (onRemixStatusChange) {","      onRemixStatusChange(remixFeed.length > 0);","    }","  }, [remixFeed.length, onRemixStatusChange]);","  ","  // ===== HELPER FUNCTIONS =====","  "],"tokenizedAddedLines":[286,1001266,55,1001267,61,1001268,61]},{"originalStartLineNumberOneIndexed":752,"originalEndLineNumberExclusiveOneIndexed":815,"modifiedStartLineNumberOneIndexed":477,"modifiedEndLineNumberExclusiveOneIndexed":521,"addedLines":["  const currentVideoUrl = currentItem.post.attachments[0]?.encodings?.md?.path || ","                         currentItem.post.attachments[0]?.encodings?.source?.path;","  const hasRemixes = remixFeed.length > 0;","  const canGoLeft = currentRemixIndex > 0;","  const canGoRight = currentRemixIndex < getAllItems().length - 1;","  ","  // Video event handlers","  const handleVideoLoad = useCallback((video: HTMLVideoElement) => {","    if (video.readyState >= 2) {","      setVideoReady(true);","    }","  }, []);","  ","  const handleVideoMetadata = useCallback((e: React.SyntheticEvent<HTMLVideoElement>) => {","    const video = e.currentTarget;","    if (video.videoWidth && video.videoHeight) {","      const aspectRatio = video.videoWidth / video.videoHeight;","      const viewportWidth = window.innerWidth;","      const viewportHeight = window.innerHeight;","      ","      if (aspectRatio > 1) {","        setVideoWidth(viewportWidth);","      } else {","        const calculatedWidth = viewportHeight * aspectRatio;","        setVideoWidth(calculatedWidth);","      }","    }","  }, []);","  ","  const handleVideoCanPlay = useCallback((video: HTMLVideoElement) => {","    setVideoReady(true);","    handleVideoLoad(video);","  }, [handleVideoLoad]);","  ","  // Toggle mute","  const toggleMute = useCallback(() => {","    const video = centerVideoRef.current;","    if (!video) return;","    ","    video.muted = !video.muted;","    setIsMuted(video.muted);","  }, []);","  ","  // ===== RENDER ====="],"tokenizedAddedLines":[59,1001269,63,64,1001270,61,1001271,1001272,1001273,1001274,55,83,61,1001275,1001276,1001277,1001278,1001279,1001280,194,1001281,1001282,216,1001283,1001284,81,55,83,61,1001285,1001286,1001287,1001288,61,1001289,1001290,1001291,170,95,325,326,83,61,1001292]},{"originalStartLineNumberOneIndexed":817,"originalEndLineNumberExclusiveOneIndexed":819,"modifiedStartLineNumberOneIndexed":523,"modifiedEndLineNumberExclusiveOneIndexed":525,"addedLines":["    <div className=\"relative w-full h-full bg-black overflow-hidden\">","      {/* Video Container */}"],"tokenizedAddedLines":[1001293,1001294]},{"originalStartLineNumberOneIndexed":820,"originalEndLineNumberExclusiveOneIndexed":821,"modifiedStartLineNumberOneIndexed":526,"modifiedEndLineNumberExclusiveOneIndexed":526},{"originalStartLineNumberOneIndexed":827,"originalEndLineNumberExclusiveOneIndexed":874,"modifiedStartLineNumberOneIndexed":532,"modifiedEndLineNumberExclusiveOneIndexed":535,"addedLines":["      >","        {/* Center Video (Current) */}","        <div className=\"absolute inset-0 w-full h-full flex items-center justify-center\" style={{ zIndex: 20 }}>"],"tokenizedAddedLines":[1001295,1001296,1001297]},{"originalStartLineNumberOneIndexed":884,"originalEndLineNumberExclusiveOneIndexed":885,"modifiedStartLineNumberOneIndexed":545,"modifiedEndLineNumberExclusiveOneIndexed":546,"addedLines":["                  ref={centerVideoRef}"],"tokenizedAddedLines":[1001298]},{"originalStartLineNumberOneIndexed":890,"originalEndLineNumberExclusiveOneIndexed":893,"modifiedStartLineNumberOneIndexed":551,"modifiedEndLineNumberExclusiveOneIndexed":553,"addedLines":["                    opacity: videoReady ? 1 : 0,","                    transition: 'opacity 0.3s ease-in-out'"],"tokenizedAddedLines":[1001299,1001300]},{"originalStartLineNumberOneIndexed":896,"originalEndLineNumberExclusiveOneIndexed":977,"modifiedStartLineNumberOneIndexed":556,"modifiedEndLineNumberExclusiveOneIndexed":560,"addedLines":["                  loop","                  onLoadedMetadata={handleVideoMetadata}","                  onCanPlay={(e) => handleVideoCanPlay(e.currentTarget)}","                  onLoadedData={(e) => handleVideoLoad(e.currentTarget)}"],"tokenizedAddedLines":[593,1001301,1001302,1001303]},{"originalStartLineNumberOneIndexed":985,"originalEndLineNumberExclusiveOneIndexed":993,"modifiedStartLineNumberOneIndexed":568,"modifiedEndLineNumberExclusiveOneIndexed":573,"addedLines":["        ","        {/* Left Video (Previous Remix) */}","        {canGoLeft && (","          <div ","            className=\"absolute inset-0 w-full h-full flex items-center justify-center\""],"tokenizedAddedLines":[433,1001304,1001305,1001306,1001307]},{"originalStartLineNumberOneIndexed":994,"originalEndLineNumberExclusiveOneIndexed":996,"modifiedStartLineNumberOneIndexed":574,"modifiedEndLineNumberExclusiveOneIndexed":576,"addedLines":["              transform: 'translateX(-100%)',","              zIndex: 10"],"tokenizedAddedLines":[1001308,1001309]},{"originalStartLineNumberOneIndexed":998,"originalEndLineNumberExclusiveOneIndexed":999,"modifiedStartLineNumberOneIndexed":578,"modifiedEndLineNumberExclusiveOneIndexed":578},{"originalStartLineNumberOneIndexed":1000,"originalEndLineNumberExclusiveOneIndexed":1011,"modifiedStartLineNumberOneIndexed":579,"modifiedEndLineNumberExclusiveOneIndexed":585,"addedLines":["              ref={leftVideoRef}","              src={getAllItems()[currentRemixIndex - 1]?.post.attachments[0]?.encodings?.md?.path || ","                   getAllItems()[currentRemixIndex - 1]?.post.attachments[0]?.encodings?.source?.path}","              className=\"h-full w-auto max-w-full object-contain\"","              loop","              muted"],"tokenizedAddedLines":[1001310,1001311,1001312,1001313,1001314,1040]},{"originalStartLineNumberOneIndexed":1012,"originalEndLineNumberExclusiveOneIndexed":1100,"modifiedStartLineNumberOneIndexed":586,"modifiedEndLineNumberExclusiveOneIndexed":588,"addedLines":["              preload=\"metadata\"","            />"],"tokenizedAddedLines":[1039,1043]},{"originalStartLineNumberOneIndexed":1103,"originalEndLineNumberExclusiveOneIndexed":1106,"modifiedStartLineNumberOneIndexed":591,"modifiedEndLineNumberExclusiveOneIndexed":593,"addedLines":["        {/* Right Video (Next Remix) */}","        {canGoRight && ("],"tokenizedAddedLines":[1001315,1001316]},{"originalStartLineNumberOneIndexed":1107,"originalEndLineNumberExclusiveOneIndexed":1108,"modifiedStartLineNumberOneIndexed":594,"modifiedEndLineNumberExclusiveOneIndexed":595,"addedLines":["            className=\"absolute inset-0 w-full h-full flex items-center justify-center\""],"tokenizedAddedLines":[1001307]},{"originalStartLineNumberOneIndexed":1109,"originalEndLineNumberExclusiveOneIndexed":1111,"modifiedStartLineNumberOneIndexed":596,"modifiedEndLineNumberExclusiveOneIndexed":598,"addedLines":["              transform: 'translateX(100%)',","              zIndex: 10"],"tokenizedAddedLines":[1001317,1001309]},{"originalStartLineNumberOneIndexed":1113,"originalEndLineNumberExclusiveOneIndexed":1114,"modifiedStartLineNumberOneIndexed":600,"modifiedEndLineNumberExclusiveOneIndexed":600},{"originalStartLineNumberOneIndexed":1115,"originalEndLineNumberExclusiveOneIndexed":1126,"modifiedStartLineNumberOneIndexed":601,"modifiedEndLineNumberExclusiveOneIndexed":607,"addedLines":["              ref={rightVideoRef}","              src={getAllItems()[currentRemixIndex + 1]?.post.attachments[0]?.encodings?.md?.path || ","                   getAllItems()[currentRemixIndex + 1]?.post.attachments[0]?.encodings?.source?.path}","              className=\"h-full w-auto max-w-full object-contain\"","              loop","              muted"],"tokenizedAddedLines":[1001318,1001319,1001320,1001313,1001314,1040]},{"originalStartLineNumberOneIndexed":1127,"originalEndLineNumberExclusiveOneIndexed":1215,"modifiedStartLineNumberOneIndexed":608,"modifiedEndLineNumberExclusiveOneIndexed":619,"addedLines":["              preload=\"metadata\"","            />","          </div>","        )}","      </motion.div>","      ","      {/* Controls Overlay */}","      {videoReady && (","        <>","          {/* Play/Pause Button */}","          {showControls && ("],"tokenizedAddedLines":[1039,1043,1027,1001321,1001322,194,1001323,1001324,1001325,1001326,1001327]},{"originalStartLineNumberOneIndexed":1216,"originalEndLineNumberExclusiveOneIndexed":1225,"modifiedStartLineNumberOneIndexed":620,"modifiedEndLineNumberExclusiveOneIndexed":630,"addedLines":["              initial={{ opacity: 0 }}","              animate={{ opacity: 1 }}","              className=\"absolute inset-0 flex items-center justify-center z-30 pointer-events-none\"","            >","              <div className=\"bg-black/50 rounded-full p-4 pointer-events-auto\">","                {isPlaying ? (","                  <div className=\"w-8 h-8\" />","                ) : (","                  <Play className=\"w-8 h-8 text-white fill-white\" />","                )}"],"tokenizedAddedLines":[1001328,1001329,1001330,610,1001331,1001332,1001333,1001334,1001335,796]},{"originalStartLineNumberOneIndexed":1227,"originalEndLineNumberExclusiveOneIndexed":1232,"modifiedStartLineNumberOneIndexed":632,"modifiedEndLineNumberExclusiveOneIndexed":637,"addedLines":["          )}","          ","          {/* Bottom Controls */}","          <motion.div ","            initial={{ opacity: 0, y: 20 }}"],"tokenizedAddedLines":[706,601,1001336,1001337,1001338]},{"originalStartLineNumberOneIndexed":1233,"originalEndLineNumberExclusiveOneIndexed":1237,"modifiedStartLineNumberOneIndexed":638,"modifiedEndLineNumberExclusiveOneIndexed":650,"addedLines":["              opacity: showControls ? 1 : 0,","              y: showControls ? 0 : 20","            }}","            className=\"absolute bottom-4 left-4 right-4 z-40\"","            style={{ pointerEvents: showControls ? 'auto' : 'none' }}","          >","            {/* Remix Navigation */}","            {hasRemixes && (","              <div className=\"flex items-center justify-center mb-4\">","                <div className=\"flex items-center gap-2 bg-black/50 rounded-full px-4 py-2\">","                  {/* Previous Button */}","                  <button"],"tokenizedAddedLines":[1001339,1001340,1001341,1001342,1001343,1001344,1001345,1001346,1001347,1001348,1001349,901]},{"originalStartLineNumberOneIndexed":1239,"originalEndLineNumberExclusiveOneIndexed":1240,"modifiedStartLineNumberOneIndexed":652,"modifiedEndLineNumberExclusiveOneIndexed":652},{"originalStartLineNumberOneIndexed":1243,"originalEndLineNumberExclusiveOneIndexed":1259,"modifiedStartLineNumberOneIndexed":655,"modifiedEndLineNumberExclusiveOneIndexed":684,"addedLines":["                    className={`p-2 rounded-full transition-all ${","                      canGoLeft ","                        ? 'bg-white/20 hover:bg-white/30 text-white' ","                        : 'bg-white/10 text-white/50 cursor-not-allowed'","                    }`}","                  >","                    <ChevronLeft className=\"w-4 h-4\" />","                  </button>","                  ","                  {/* Remix Dots */}","                  <div className=\"flex items-center gap-1 mx-2\">","                    {getAllItems().map((_, index) => (","                      <button","                        key={index}","                        onClick={(e) => {","                          e.stopPropagation();","                          goToRemixIndex(index);","                        }}","                        className={`w-2 h-2 rounded-full transition-all ${","                          currentRemixIndex === index","                            ? 'bg-white scale-125' ","                            : 'bg-white/50 hover:bg-white/70'","                        }`}","                      />","                    ))}","                  </div>","                  ","                  {/* Next Button */}","                  <button"],"tokenizedAddedLines":[1001350,1001351,1001352,1001353,1001354,793,1001355,911,1001356,1001357,1001358,1001359,1001360,1001361,1001362,880,1001363,1001364,1001365,1001366,1001367,1001368,1001369,1001370,1001371,873,1001356,1001372,901]},{"originalStartLineNumberOneIndexed":1261,"originalEndLineNumberExclusiveOneIndexed":1262,"modifiedStartLineNumberOneIndexed":686,"modifiedEndLineNumberExclusiveOneIndexed":686},{"originalStartLineNumberOneIndexed":1265,"originalEndLineNumberExclusiveOneIndexed":1290,"modifiedStartLineNumberOneIndexed":689,"modifiedEndLineNumberExclusiveOneIndexed":705,"addedLines":["                    className={`p-2 rounded-full transition-all ${","                      canGoRight ","                        ? 'bg-white/20 hover:bg-white/30 text-white' ","                        : 'bg-white/10 text-white/50 cursor-not-allowed'","                    }`}","                  >","                    <ChevronRight className=\"w-4 h-4\" />","                  </button>","                </div>","              </div>","            )}","            ","            {/* Video Info */}","            <div className=\"flex items-end justify-between\">","              {/* Left side - Video info */}","              <div className=\"flex-1 min-w-0 mr-4\">"],"tokenizedAddedLines":[1001350,1001373,1001352,1001353,1001354,793,1001374,911,704,598,1001375,577,1001376,1001377,1001378,1001379]},{"originalStartLineNumberOneIndexed":1291,"originalEndLineNumberExclusiveOneIndexed":1302,"modifiedStartLineNumberOneIndexed":706,"modifiedEndLineNumberExclusiveOneIndexed":708,"addedLines":["                  <div className=\"w-8 h-8 bg-gradient-to-br from-purple-500 to-pink-500 rounded-full flex items-center justify-center\">","                    <User className=\"w-4 h-4 text-white\" />"],"tokenizedAddedLines":[1001380,1001381]},{"originalStartLineNumberOneIndexed":1303,"originalEndLineNumberExclusiveOneIndexed":1307,"modifiedStartLineNumberOneIndexed":709,"modifiedEndLineNumberExclusiveOneIndexed":711,"addedLines":["                  <span className=\"text-white font-semibold text-sm\">","                    Sora User"],"tokenizedAddedLines":[1001382,1001383]},{"originalStartLineNumberOneIndexed":1308,"originalEndLineNumberExclusiveOneIndexed":1319,"modifiedStartLineNumberOneIndexed":712,"modifiedEndLineNumberExclusiveOneIndexed":713,"addedLines":["                  <CheckCircle className=\"w-4 h-4 text-blue-400\" />"],"tokenizedAddedLines":[1001384]},{"originalStartLineNumberOneIndexed":1321,"originalEndLineNumberExclusiveOneIndexed":1322,"modifiedStartLineNumberOneIndexed":715,"modifiedEndLineNumberExclusiveOneIndexed":715},{"originalStartLineNumberOneIndexed":1324,"originalEndLineNumberExclusiveOneIndexed":1325,"modifiedStartLineNumberOneIndexed":717,"modifiedEndLineNumberExclusiveOneIndexed":718,"addedLines":["                    className={`text-white text-xs ${currentItem.post.text.length > 100 ? 'cursor-pointer' : ''}`}"],"tokenizedAddedLines":[1001385]},{"originalStartLineNumberOneIndexed":1335,"originalEndLineNumberExclusiveOneIndexed":1336,"modifiedStartLineNumberOneIndexed":728,"modifiedEndLineNumberExclusiveOneIndexed":729,"addedLines":["                    {currentItem.post.text.length > 100 && ("],"tokenizedAddedLines":[1001386]},{"originalStartLineNumberOneIndexed":1349,"originalEndLineNumberExclusiveOneIndexed":1367,"modifiedStartLineNumberOneIndexed":742,"modifiedEndLineNumberExclusiveOneIndexed":746,"addedLines":["              ","              {/* Right side - Action buttons */}","              <div className=\"flex flex-col gap-3\">","                {/* Mute Button */}"],"tokenizedAddedLines":[1001387,1001388,1001389,938]},{"originalStartLineNumberOneIndexed":1370,"originalEndLineNumberExclusiveOneIndexed":1379,"modifiedStartLineNumberOneIndexed":749,"modifiedEndLineNumberExclusiveOneIndexed":758,"addedLines":["                    toggleMute();","                  }}","                  className=\"p-3 rounded-full bg-black/50 hover:bg-black/70 transition-all\"","                >","                  {isMuted ? (","                    <VolumeX className=\"w-5 h-5 text-white\" />","                  ) : (","                    <Volume2 className=\"w-5 h-5 text-white\" />","                  )}"],"tokenizedAddedLines":[939,617,1001390,618,1001391,1001392,1001393,1001394,703]},{"originalStartLineNumberOneIndexed":1381,"originalEndLineNumberExclusiveOneIndexed":1382,"modifiedStartLineNumberOneIndexed":760,"modifiedEndLineNumberExclusiveOneIndexed":761,"addedLines":["                {/* Like Button */}"],"tokenizedAddedLines":[1001395]},{"originalStartLineNumberOneIndexed":1385,"originalEndLineNumberExclusiveOneIndexed":1403,"modifiedStartLineNumberOneIndexed":764,"modifiedEndLineNumberExclusiveOneIndexed":764},{"originalStartLineNumberOneIndexed":1404,"originalEndLineNumberExclusiveOneIndexed":1407,"modifiedStartLineNumberOneIndexed":765,"modifiedEndLineNumberExclusiveOneIndexed":766,"addedLines":["                      onRemoveFromFavorites?.(currentItem.post.id);"],"tokenizedAddedLines":[1001396]},{"originalStartLineNumberOneIndexed":1409,"originalEndLineNumberExclusiveOneIndexed":1412,"modifiedStartLineNumberOneIndexed":768,"modifiedEndLineNumberExclusiveOneIndexed":769,"addedLines":["                      onAddToFavorites?.(currentItem);"],"tokenizedAddedLines":[1001397]},{"originalStartLineNumberOneIndexed":1415,"originalEndLineNumberExclusiveOneIndexed":1418,"modifiedStartLineNumberOneIndexed":772,"modifiedEndLineNumberExclusiveOneIndexed":773,"addedLines":["                  className=\"p-3 rounded-full bg-black/50 hover:bg-black/70 transition-all\""],"tokenizedAddedLines":[1001390]},{"originalStartLineNumberOneIndexed":1419,"originalEndLineNumberExclusiveOneIndexed":1420,"modifiedStartLineNumberOneIndexed":774,"modifiedEndLineNumberExclusiveOneIndexed":777,"addedLines":["                  <Heart ","                    className={`w-5 h-5 ${isLiked ? 'text-red-500 fill-red-500' : 'text-white'}`} ","                  />"],"tokenizedAddedLines":[1001398,1001399,1001400]},{"originalStartLineNumberOneIndexed":1421,"originalEndLineNumberExclusiveOneIndexed":1459,"modifiedStartLineNumberOneIndexed":778,"modifiedEndLineNumberExclusiveOneIndexed":778},{"originalStartLineNumberOneIndexed":1460,"originalEndLineNumberExclusiveOneIndexed":1461,"modifiedStartLineNumberOneIndexed":779,"modifiedEndLineNumberExclusiveOneIndexed":780,"addedLines":["            </div>"],"tokenizedAddedLines":[705]},{"originalStartLineNumberOneIndexed":1462,"originalEndLineNumberExclusiveOneIndexed":1605,"modifiedStartLineNumberOneIndexed":781,"modifiedEndLineNumberExclusiveOneIndexed":783,"addedLines":["        </>","      )}"],"tokenizedAddedLines":[1001401,1001402]},{"originalStartLineNumberOneIndexed":1608,"originalEndLineNumberExclusiveOneIndexed":1609,"modifiedStartLineNumberOneIndexed":786,"modifiedEndLineNumberExclusiveOneIndexed":786}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}