{"fsPath":"\\home\\hendo420\\soraFeed\\src\\components\\VideoPost.tsx","fileUuid":"87a70454-eb0e-44a7-998a-0bce14251450","fileSizeBytes":11242,"numLines":354,"diffChanges":[{"originalStartLineNumberOneIndexed":5,"originalEndLineNumberExclusiveOneIndexed":7,"modifiedStartLineNumberOneIndexed":5,"modifiedEndLineNumberExclusiveOneIndexed":8,"addedLines":["import { Play, Pause, Volume2, VolumeX, Heart, Share, User, CheckCircle, ChevronLeft, ChevronRight } from 'lucide-react';","import { SoraFeedItem, SoraRemixTree } from '@/types/sora';","import { fetchRemixTree } from '@/lib/api';"],"tokenizedAddedLines":[1000155,1000156,1000157]},{"originalStartLineNumberOneIndexed":20,"originalEndLineNumberExclusiveOneIndexed":20,"modifiedStartLineNumberOneIndexed":21,"modifiedEndLineNumberExclusiveOneIndexed":24,"addedLines":["  const [remixTree, setRemixTree] = useState<SoraRemixTree | null>(null);","  const [currentRemixIndex, setCurrentRemixIndex] = useState(0);","  const [loadingRemixes, setLoadingRemixes] = useState(false);"],"tokenizedAddedLines":[1000158,1000159,1000160]},{"originalStartLineNumberOneIndexed":35,"originalEndLineNumberExclusiveOneIndexed":35,"modifiedStartLineNumberOneIndexed":39,"modifiedEndLineNumberExclusiveOneIndexed":44,"addedLines":["      ","      // Fetch remix tree when video becomes active","      if (!remixTree && !loadingRemixes) {","        loadRemixTree();","      }"],"tokenizedAddedLines":[1000161,1000162,1000163,1000164,1000165]},{"originalStartLineNumberOneIndexed":40,"originalEndLineNumberExclusiveOneIndexed":40,"modifiedStartLineNumberOneIndexed":49,"modifiedEndLineNumberExclusiveOneIndexed":75,"addedLines":["","  // Handle video changes when switching remixes","  useEffect(() => {","    const video = videoRef.current;","    if (!video) return;","","    if (isActive && isPlaying) {","      video.play().catch(() => {","        setIsPlaying(false);","      });","    }","  }, [currentRemixIndex, currentVideoUrl]);","","  const loadRemixTree = async () => {","    try {","      setLoadingRemixes(true);","      console.log('ðŸ”„ Loading remix tree for post:', item.post.id);","      const tree = await fetchRemixTree(item.post.id);","      setRemixTree(tree);","      console.log('âœ… Loaded', tree.children?.items?.length || 0, 'remixes');","    } catch (error) {","      console.error('âŒ Failed to load remix tree:', error);","    } finally {","      setLoadingRemixes(false);","    }","  };"],"tokenizedAddedLines":[2,1000166,21,22,23,2,1000167,1000168,28,29,33,1000169,2,1000170,1000171,1000172,1000173,1000174,1000175,1000176,1000177,1000178,1000179,1000180,33,37]},{"originalStartLineNumberOneIndexed":68,"originalEndLineNumberExclusiveOneIndexed":68,"modifiedStartLineNumberOneIndexed":103,"modifiedEndLineNumberExclusiveOneIndexed":132,"addedLines":["","  const goToPreviousRemix = () => {","    if (currentRemixIndex > 0) {","      setCurrentRemixIndex(currentRemixIndex - 1);","    }","  };","","  const goToNextRemix = () => {","    const maxIndex = remixTree?.children?.items?.length || 0;","    if (currentRemixIndex < maxIndex) {","      setCurrentRemixIndex(currentRemixIndex + 1);","    }","  };","","  // Get current item (original post or remix)","  const getCurrentItem = (): SoraFeedItem => {","    if (currentRemixIndex === 0 || !remixTree) {","      return item; // Original post","    }","    return remixTree.children.items[currentRemixIndex - 1]; // Remix (index - 1 because 0 is original)","  };","","  const currentItem = getCurrentItem();","  const currentVideoUrl = currentItem.post.attachments[0]?.encodings?.md?.path || ","                          currentItem.post.attachments[0]?.encodings?.source?.path;","  ","  const hasRemixes = (remixTree?.children?.items?.length || 0) > 0;","  const canGoLeft = currentRemixIndex > 0;","  const canGoRight = currentRemixIndex < (remixTree?.children?.items?.length || 0);"],"tokenizedAddedLines":[2,1000181,1000182,1000183,33,37,2,1000184,1000185,1000186,1000187,33,37,2,1000188,1000189,1000190,1000191,33,1000192,37,2,1000193,1000194,1000195,1000196,1000197,1000198,1000199]},{"originalStartLineNumberOneIndexed":103,"originalEndLineNumberExclusiveOneIndexed":104,"modifiedStartLineNumberOneIndexed":167,"modifiedEndLineNumberExclusiveOneIndexed":169,"addedLines":["        poster={currentItem.post.attachments[0]?.encodings?.thumbnail?.path}","        key={currentItem.post.id} // Force re-render when switching remixes"],"tokenizedAddedLines":[1000200,1000201]},{"originalStartLineNumberOneIndexed":105,"originalEndLineNumberExclusiveOneIndexed":106,"modifiedStartLineNumberOneIndexed":170,"modifiedEndLineNumberExclusiveOneIndexed":171,"addedLines":["        {currentVideoUrl && <source src={currentVideoUrl} type=\"video/mp4\" />}"],"tokenizedAddedLines":[1000202]},{"originalStartLineNumberOneIndexed":130,"originalEndLineNumberExclusiveOneIndexed":130,"modifiedStartLineNumberOneIndexed":195,"modifiedEndLineNumberExclusiveOneIndexed":249,"addedLines":["","      {/* Horizontal Navigation for Remixes */}","      {hasRemixes && (","        <>","          {/* Left Arrow */}","          <motion.button","            initial={{ opacity: 0, x: -20 }}","            animate={{ ","              opacity: (showControls && canGoLeft) ? 1 : 0,","              x: (showControls && canGoLeft) ? 0 : -20","            }}","            transition={{ duration: 0.2 }}","            onClick={(e) => {","              e.stopPropagation();","              goToPreviousRemix();","            }}","            className=\"absolute left-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/50 text-white hover:bg-black/70 transition-all\"","            disabled={!canGoLeft}","          >","            <ChevronLeft size={24} />","          </motion.button>","","          {/* Right Arrow */}","          <motion.button","            initial={{ opacity: 0, x: 20 }}","            animate={{ ","              opacity: (showControls && canGoRight) ? 1 : 0,","              x: (showControls && canGoRight) ? 0 : 20","            }}","            transition={{ duration: 0.2 }}","            onClick={(e) => {","              e.stopPropagation();","              goToNextRemix();","            }}","            className=\"absolute right-4 top-1/2 -translate-y-1/2 z-20 p-3 rounded-full bg-black/50 text-white hover:bg-black/70 transition-all\"","            disabled={!canGoRight}","          >","            <ChevronRight size={24} />","          </motion.button>","","          {/* Remix Indicator */}","          <motion.div","            initial={{ opacity: 0, y: -20 }}","            animate={{ ","              opacity: showControls ? 1 : 0,","              y: showControls ? 0 : -20","            }}","            transition={{ duration: 0.2 }}","            className=\"absolute top-4 left-4 z-10 px-3 py-1 rounded-full bg-black/50 text-white text-sm\"","          >","            {currentRemixIndex === 0 ? 'Original' : `Remix ${currentRemixIndex}/${remixTree?.children?.items?.length || 0}`}","          </motion.div>","        </>","      )}"],"tokenizedAddedLines":[2,1000203,1000204,1000205,1000206,1000207,1000208,1000209,1000210,1000211,1000212,1000213,1000214,1000215,1000216,1000212,1000217,1000218,1000219,1000220,1000221,2,1000222,1000207,1000223,1000209,1000224,1000225,1000212,1000213,1000214,1000215,1000226,1000212,1000227,1000228,1000219,1000229,1000221,2,1000230,1000231,1000232,1000209,1000233,1000234,1000212,1000213,1000235,1000219,1000236,1000237,1000238,1000239]},{"originalStartLineNumberOneIndexed":149,"originalEndLineNumberExclusiveOneIndexed":150,"modifiedStartLineNumberOneIndexed":268,"modifiedEndLineNumberExclusiveOneIndexed":269,"addedLines":["                {currentItem.profile.display_name || currentItem.profile.username}"],"tokenizedAddedLines":[1000240]},{"originalStartLineNumberOneIndexed":151,"originalEndLineNumberExclusiveOneIndexed":152,"modifiedStartLineNumberOneIndexed":270,"modifiedEndLineNumberExclusiveOneIndexed":271,"addedLines":["              {currentItem.profile.verified && ("],"tokenizedAddedLines":[1000241]},{"originalStartLineNumberOneIndexed":155,"originalEndLineNumberExclusiveOneIndexed":156,"modifiedStartLineNumberOneIndexed":274,"modifiedEndLineNumberExclusiveOneIndexed":275,"addedLines":["                {formatTimeAgo(currentItem.post.posted_at)}"],"tokenizedAddedLines":[1000242]},{"originalStartLineNumberOneIndexed":159,"originalEndLineNumberExclusiveOneIndexed":160,"modifiedStartLineNumberOneIndexed":278,"modifiedEndLineNumberExclusiveOneIndexed":279,"addedLines":["              {formatCount(currentItem.profile.follower_count)} followers"],"tokenizedAddedLines":[1000243]},{"originalStartLineNumberOneIndexed":165,"originalEndLineNumberExclusiveOneIndexed":166,"modifiedStartLineNumberOneIndexed":284,"modifiedEndLineNumberExclusiveOneIndexed":285,"addedLines":["        {currentItem.post.text && ("],"tokenizedAddedLines":[1000244]},{"originalStartLineNumberOneIndexed":167,"originalEndLineNumberExclusiveOneIndexed":168,"modifiedStartLineNumberOneIndexed":286,"modifiedEndLineNumberExclusiveOneIndexed":287,"addedLines":["            {currentItem.post.text}"],"tokenizedAddedLines":[1000245]}],"gitInfo":{"noRepoFound":true},"kind":"KIND_MODIFIED"}